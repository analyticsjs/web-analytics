/**
 * name: @web-analytics/monorepo
 * version: v0.0.0
 * description: Website pageviews analytics tools.
 * author: chengpeiquan <chengpeiquan@chengpeiquan.com>
 * homepage: https://analytics.chengpeiquan.com
 */
import{V as f,a2 as U,a3 as S,a4 as q,a5 as T,a6 as D,a7 as L,a8 as R,a9 as M,aa as x,ab as V,ac as F,d as N,u as B,j as K,A as G,ad as Q,ae as H,af as J,ag as W}from"./chunks/framework.76b79cb5.js";import{t as X}from"./chunks/theme.a0a26523.js";function c(){return typeof window<"u"?navigator.userAgent.toLowerCase():""}const k=typeof window<"u";/Android/i.test(c());/iPhone|iPod|iPad|iOS/i.test(c());/uni-app|html5plus/.test(c());/MicroMessenger/i.test(c());/\sQQ|mqqbrowser|qzone|qqbrowser/i.test(c());/mqqbrowser|qqbrowser/i.test(c());/qzone\/.*_qz_([\d.]+)/i.test(c());/(weibo).*weibo__([\d.]+)/i.test(c());/(baiduboxapp)\/([\d.]+)/i.test(c());function Y([t,...e]){return t?t.toUpperCase()+e.join(""):""}function Z([t,...e]){return t?(t.toLowerCase()+e.join("")).replace(/[-_](\w)/g,(n,s)=>s?s.toUpperCase():""):""}function tt(t){return t?Y(Z(t)):""}function et({type:t,id:e,resource:n}){return new Promise((s,a)=>{if(!k||document.querySelector(`#${e}`)){a();return}function i(r){r.addEventListener("load",s),r.addEventListener("error",a),r.addEventListener("abort",a)}switch(t){case"js":{const r=document.createElement("script");r.id=e,r.async=!0,r.src=n,i(r),document.head.appendChild(r);break}case"css":{const r=document.createElement("link");r.id=e,r.rel="stylesheet",r.href=n,i(r),document.head.appendChild(r);break}case"style":{const r=document.createElement("style");r.id=e,i(r),document.head.appendChild(r),r.appendChild(document.createTextNode(n));break}}})}function nt(){try{return"production"}catch{return}}nt();function I(t){try{return t==="production"}catch{return!1}}I("development");I("test");I("production");var st=Object.defineProperty,at=(t,e,n)=>e in t?st(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,p=(t,e,n)=>(at(t,typeof e!="symbol"?e+"":e,n),n);const rt="web-analytics-core",$=["baidu","cnzz"];var u=(t=>(t.SetAutoPageview="_setAutoPageview",t.SetAccount="_setAccount",t.TrackPageview="_trackPageview",t.TrackEvent="_trackEvent",t))(u||{});function it({pluginId:t,platform:e,websiteId:n,propertyKey:s,args:a}){const i=[];switch(s){case"loadSdk":{i.push("JS-SDK load done.");break}case"setAccount":{i.push("set account done.");break}case"trackPageview":{const{pageUrl:o,fromUrl:d}=a[0]||{};i.push("track pageview done."),i.push(`pageUrl:      ${b(o)}`),e==="cnzz"&&d&&i.push(`fromUrl:      ${b(d)}`);break}case"trackEvent":{const{category:o,action:d,label:w,value:_,nodeId:C}=a[0]||{};i.push("track event done."),i.push(`category:     ${o}`),i.push(`action:       ${d}`),i.push(`label:        ${y(w)}`),i.push(`value:        ${v(_)}`),e==="cnzz"&&i.push(`nodeId:       ${E(C)}`);break}}i.push(`websiteId:    ${n}`),i.push(`time:         ${new Date}`);const r=i.join(`
`);return`
[${t}] ${tt(e)} Analytics ${r}

`}function b(t){if((!t||typeof t!="string")&&(t="/"),t.startsWith("http")){const e=t.split("/"),n=`${e[0]}//${e[2]}`;t=t.replace(n,"")}return t}function ot(t){return(!t||t&&typeof t!="string")&&(t=""),typeof t=="string"&&!t.includes("http")&&(t=""),t}function E(t){return(!t||typeof t!="string")&&(t=""),t}function y(t){return(!t||typeof t!="string")&&(t=""),t}function v(t){return(!t||!Number(t))&&(t=1),t}function P(t,e,n){const s=n.value;return n.value=function(...a){const{debug:i,pluginId:r,platform:o,websiteId:d}=this;if(i){const w=it({pluginId:r,platform:o,websiteId:d,propertyKey:e,args:a});console.log(w)}s.apply(this,a)},n}function ct(t,e,n){const s=n.value;return n.value=function(...a){const[i]=a,{category:r,action:o}=i;if(typeof r!="string"||typeof o!="string"||!r||!o){this.throwError("Valid `category` and `action` are missing from the track event options.");return}s.apply(this,a)},n}var ut=Object.defineProperty,dt=Object.getOwnPropertyDescriptor,pt=(t,e,n,s)=>{for(var a=s>1?void 0:s?dt(e,n):e,i=t.length-1,r;i>=0;i--)(r=t[i])&&(a=(s?r(e,n,a):r(a))||a);return s&&a&&ut(e,n,a),a};class z{constructor({pluginId:e,platform:n,websiteId:s,debug:a}){p(this,"pluginId"),p(this,"platform"),p(this,"sdkInstance"),p(this,"sdkUrl",""),p(this,"websiteId",""),p(this,"debug"),this.pluginId=e||rt,this.platform=n,this.websiteId=s,this.debug=a??!1,this.updatePlatformInfo(),this.loadSdk()}updatePlatformInfo(){if(k)switch(this.platform){case"baidu":{this.sdkInstance=window._hmt||[],this.sdkUrl=`https://hm.baidu.com/hm.js?${this.websiteId}`;break}case"cnzz":{this.sdkInstance=window._czc||[],this.sdkUrl=`https://v1.cnzz.com/z_stat.php?id=${this.websiteId}&web_id=${this.websiteId}`;break}default:{const e=$.join(", ");this.throwError(`Unsupported platform options, only supported: ${e}.`)}}}loadSdk(){!this.sdkInstance||!this.sdkUrl||(this.sdkInstance.push([u.SetAutoPageview,!1]),et({type:"js",id:`${this.pluginId}-${this.platform}-${this.websiteId}`,resource:this.sdkUrl}).catch(e=>{console.log(e)}))}throwError(e){throw new Error(`[${this.pluginId}] ${e}`)}}pt([P],z.prototype,"loadSdk",1);var lt=Object.defineProperty,ht=Object.getOwnPropertyDescriptor,j=(t,e,n,s)=>{for(var a=s>1?void 0:s?ht(e,n):e,i=t.length-1,r;i>=0;i--)(r=t[i])&&(a=(s?r(e,n,a):r(a))||a);return s&&a&&lt(e,n,a),a};let g=class extends z{constructor({pluginId:e,platform:n,websiteId:s,debug:a}){super({pluginId:e,platform:n,websiteId:s,debug:a})}setAccount(){this.sdkInstance&&this.sdkInstance.push([u.SetAccount,this.websiteId])}trackPageview({pageUrl:e,fromUrl:n}){if(this.sdkInstance)switch(this.setAccount(),this.platform){case"baidu":{this.sdkInstance.push([u.TrackPageview,b(e)]);break}case"cnzz":{this.sdkInstance.push([u.TrackPageview,b(e),n?ot(n):""]);break}}}trackEvent({category:e,action:n,label:s,value:a,nodeId:i}){if(this.sdkInstance)switch(this.setAccount(),this.platform){case"baidu":{this.sdkInstance.push([u.TrackEvent,e,n,y(s),v(a)]);break}case"cnzz":{this.sdkInstance.push([u.TrackEvent,e,n,y(s),v(a),E(i)]);break}}}};j([P],g.prototype,"trackPageview",1);j([P,ct],g.prototype,"trackEvent",1);function ft(t){return new g({platform:"baidu",...t})}function bt(t){return new g({platform:"cnzz",...t})}var gt=Object.defineProperty,wt=(t,e,n)=>e in t?gt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,h=(t,e,n)=>(wt(t,typeof e!="symbol"?e+"":e,n),n);class mt{constructor({platform:e,websiteIds:n,debug:s}){h(this,"pluginId"),h(this,"platform"),h(this,"websiteIds"),h(this,"instances"),h(this,"debug"),this.pluginId="web-analytics-vue",this.platform=e,this.websiteIds=n||[],this.instances=[],this.debug=s??!1,this.init()}init(){try{switch(this.platform){case"baidu":{this.websiteIds.forEach(e=>{const n=ft({pluginId:this.pluginId,websiteId:e,debug:this.debug});this.instances.push(n)});break}case"cnzz":{this.websiteIds.forEach(e=>{const n=bt({pluginId:this.pluginId,websiteId:e,debug:this.debug});this.instances.push(n)});break}default:{const e=$.join(", ");this.throwError(`Unsupported platform options, only supported: ${e}.`);break}}}catch(e){this.throwError(`Plugin initialization failed: ${e}.`)}}trackPageview(e){this.instances.forEach(n=>n.trackPageview({...e}))}trackEvent(e){this.instances.forEach(n=>n.trackEvent({...e}))}throwError(e){throw new Error(`[${this.pluginId}] ${e}`)}}function yt({version:t}){try{const[e]=t.split(".");return e?Number(e):3}catch{return 3}}function vt(t){return $.includes(t)?`$${t}Analytics`:""}function kt({analytics:t,platform:e}){return(n,s)=>{if(!k)return;const a=new mt({platform:e,...s});for(const o in a)Object.prototype.hasOwnProperty.call(a,o)&&(t[o]=a[o]);const i=Object.getPrototypeOf(a);Object.setPrototypeOf(t,i);const r=vt(e);if(r)switch(yt(n)){case 2:{n.prototype[r]=t;break}case 3:{n.config.globalProperties[r]=t;break}}}}function It(){const t={};return{baiduAnalytics:t,registerBaiduAnalytics:kt({analytics:t,platform:"baidu"})}}const m={"guide.html":"guide/getting-started","docs.html":"docs/basic-usage"};function $t(){if(f){for(const t in m)if(Object.prototype.hasOwnProperty.call(m,t)){const{pathname:e}=window.location;if(e.match(t)){const s=m[t];window.location.replace(s)}}}}const{baiduAnalytics:A,registerBaiduAnalytics:Pt}=It(),At={...X,enhanceApp({app:t,router:e}){f&&($t(),Pt(t,{websiteIds:["8dca8e2532df48ea7f1b15c714588691","ae70e8f142fc9722f09c0076ce5cd1db"]}),window.addEventListener("hashchange",()=>{A.trackPageview({pageUrl:window.location.href})}),e.onAfterRouteChanged=n=>{A.trackPageview({pageUrl:n})})}};function O(t){if(t.extends){const e=O(t.extends);return{...e,...t,async enhanceApp(n){e.enhanceApp&&await e.enhanceApp(n),t.enhanceApp&&await t.enhanceApp(n)}}}return t}const l=O(At),Et=N({name:"VitePressApp",setup(){const{site:t}=B();return K(()=>{G(()=>{document.documentElement.lang=t.value.lang,document.documentElement.dir=t.value.dir})}),Q(),H(),J(),l.setup&&l.setup(),()=>W(l.Layout)}});async function zt(){const t=Ot(),e=jt();e.provide(S,t);const n=q(t.route);return e.provide(T,n),e.component("Content",D),e.component("ClientOnly",L),Object.defineProperties(e.config.globalProperties,{$frontmatter:{get(){return n.frontmatter.value}},$params:{get(){return n.page.value.params}}}),l.enhanceApp&&await l.enhanceApp({app:e,router:t,siteData:R}),{app:e,router:t,data:n}}function jt(){return M(Et)}function Ot(){let t=f,e;return x(n=>{let s=V(n);return s?(t&&(e=s),(t||e===s)&&(s=s.replace(/\.js$/,".lean.js")),f&&(t=!1),F(()=>import(s),[])):null},l.NotFound)}f&&zt().then(({app:t,router:e,data:n})=>{e.go().then(()=>{U(e.route,n.site),t.mount("#app")})});export{zt as createApp};
